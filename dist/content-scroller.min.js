!function(t,e){"use strict";"function"==typeof define&&define.amd?define(["exports"],function(s){return e(t,s)}):t.Scroll=e(t,{})}(window,function(t,e,s){"use strict";function i(t){return o.getElementById(t)}function r(t,e,s,i){var r=["translate3d(",e||0,"px,",s||0,"px,",i||0,"px",")"].join("");t.style[n]=r}function l(t){return t.style[n]}var o=t.document,o=t.document,h="ontouchstart"in t,n=function(t){for(var e=o.createElement("div"),i=0,r=t.length;r>i;i++){var l=t[i];if(e.style[l]!==s)return l}}(["transform","webkitTransform","mozTransform","oTransform","msTransform"]),a=5,_=20,c=15;return e=function(t){this.initialize(t)},e.prototype={constructor:e,initialize:function(t){return t=t||{},this._ui={},this._ui.scrollWrap=t.scrollWrap||i("js-scroll-wrap"),this._ui.scrollArea=t.scrollArea||i("js-scroll-area"),this._ui.scrollBar=t.scrollBar||i("js-scroll-bar"),this._ensureElm(),this._disableScrollBar=t.disableScrollBar||!1,this._startAtBottom=t.startAtBottom||!1,this._isTouching=!1,this._timer=null,this._startAreaY=null,this._startTouchY=null,this._preAreaY=null,this._newAreaY=null,this._limitAreaY=null,this._speedY=null,this._newBarY=null,this._distScroll=null,this._distBar=null,this},_ensureElm:function(){var t=!this._ui.scrollWrap,e=!this._ui.scrollArea;if(t||e)throw new Error("#scrollWrap or #scrollArea is not exist!");return!0},start:function(){if(!h)return void(this._ui.scrollWrap.style.overflow="scroll");var t=this._ui.scrollWrap.offsetHeight,e=this._ui.scrollArea.offsetHeight,s=t>e?t:e,i=t>e;return i?void(this._disableScrollBar=!0):(this._setScrollBar(t,s),this._clearTimer()._setTimer(),this._removeEventLitener()._addEventLitener(),this._limitAreaY=s-t,void this._setScrollAreaY(this._startAtBottom?-this._limitAreaY:0))},dispose:function(){this._disableScrollBar||this._setScrollBarHeight(0),this._setScrollAreaY(0),this._removeEventLitener(),this._clearTimer()},handleEvent:function(t){switch(t.type){case"touchstart":this._onStart(t);break;case"touchmove":this._onMove(t);break;case"touchend":this._onEnd(t)}},_setScrollBar:function(t,e){if(!this._disableScrollBar){var s=~~(t*t/e);this._setScrollBarHeight(s),this._distScroll=e-t,this._distBar=t-s}},_addEventLitener:function(){return this._ui.scrollArea.addEventListener("touchstart",this,!1),this._ui.scrollArea.addEventListener("touchend",this,!1),this},_removeEventLitener:function(){return this._ui.scrollArea.removeEventListener("touchstart",this,!1),this._ui.scrollArea.removeEventListener("touchend",this,!1),this._ui.scrollArea.removeEventListener("touchmove",this,!1),this},_onStart:function(t){this._clearTimer(),this._isTouching=!0,this._preAreaY=0,this._speedY=0,this._startTouchY=t.changedTouches[0].pageY,this._startAreaY=this._getScrollAreaY(),this._ui.scrollArea.addEventListener("touchmove",this,!1)},_onEnd:function(t){var e=t.changedTouches[0].pageY;this._startTouchY-e<a&&this._startTouchY-e>-a&&(this._speedY=0),this._startTouchY-e<0&&this._speedY<0&&(this._speedY*=-1),this._isTouching=!1,this._ui.scrollArea.removeEventListener("touchmove",this,!1),this._setTimer()},_onMove:function(t){t.preventDefault();var e=t.changedTouches[0].pageY,s=this._getScrollAreaY();this._newAreaY=e-this._startTouchY+this._startAreaY,this._setScrollAreaY(this._newAreaY),this._speedY=s-this._preAreaY,this._speedY<-_&&(this._speedY=-_+.1*this._speedY),this._speedY>_&&(this._speedY=_+.1*this._speedY),this._preAreaY=s,this._newBarY=this._newAreaY*this._distBar/this._distScroll,this._followScrollBar()},_getScrollAreaY:function(){var t=l(this._ui.scrollArea),e=t.split(",")[1]||0;return e=parseInt(e,10)},_setScrollAreaY:function(t){t=parseInt(t,10),r(this._ui.scrollArea,0,t)},_followScrollBar:function(){this._disableScrollBar||(this._newBarY=this._newAreaY*this._distBar/this._distScroll,r(this._ui.scrollBar,0,-this._newBarY))},_setScrollBarHeight:function(t){t=0|t,this._ui.scrollBar.style.height=t+"px"},_setTimer:function(){var t=this;return this._timer=setInterval(function(){t._loop()},c),this},_clearTimer:function(){return clearInterval(this._timer),this._timer=null,this},_loop:function(){if(!this._isTouching){var t=this._getScrollAreaY();t>0?(this._newAreaY=t-t/12,this._speedY=0,this._setScrollAreaY(this._newAreaY),2>t&&this._setScrollAreaY(0)):t<-this._limitAreaY?(this._newAreaY=t+(-this._limitAreaY-t)/12,this._speedY=0,this._setScrollAreaY(this._newAreaY),t>-this._limitAreaY-1&&this._setScrollAreaY(this._limitAreaY)):(this._newAreaY=t+this._speedY,this._speedY*=.9,this._setScrollAreaY(this._newAreaY),Math.abs(this._speedY)<.1&&(this._speedY=0),0===this._speedY&&this._clearTimer()),this._followScrollBar()}}},e});