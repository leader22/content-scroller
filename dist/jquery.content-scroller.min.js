!function(t,i){"use strict";"function"==typeof define&&define.amd?define(["jquery","exports"],function(s,e){return i(t,e,s)}):t.Scroll=i(t,{},t.jQuery||t.$)}(window,function(t,i,s,e){"use strict";function r(t,i,s,e){var r=["translate3d(",i||0,"px,",s||0,"px,",e||0,"px",")"].join("");t.style[a]=r}function l(t){return t.style[a]}var h="ontouchstart"in t,o=t.document,a=function(t){for(var i=o.createElement("div"),s=0,r=t.length;r>s;s++){var l=t[s];if(i.style[l]!==e)return l}}(["transform","webkitTransform","mozTransform","oTransform","msTransform"]);return i=function(t){this.initialize(t)},i.prototype={constructor:i,initialize:function(t){return t=t||{},this._ui=s.extend({scrollWrap:s("#js-scroll-wrap"),scrollArea:s("#js-scroll-area"),scrollBar:s("#js-scroll-bar")},t),this._ensureElm(),this._disableScrollBar=t.disableScrollBar||!1,this._startAtBottom=t.startAtBottom||!1,this._isTouching=!1,this._timer=null,this._startAreaY=null,this._startTouchY=null,this._preAreaY=null,this._newAreaY=null,this._limitAreaY=null,this._speedY=null,this._newBarY=null,this._distScroll=null,this._distBar=null,this},_ensureElm:function(){var t=0===this._ui.scrollWrap.length,i=0===this._ui.scrollArea.length;if(t||i)throw new Error("#scrollWrap or #scrollArea is not exist!")},start:function(){var t=this._ui.scrollWrap.height(),i=this._ui.scrollArea.height(),s=t>i?t:i,e=t>i;return e?void(this._disableScrollBar=!0):(this._setScrollBar(t,s),this._clearTimer()._setTimer(),this._removeEventLitener()._addEventLitener(),this._limitAreaY=s-t,void this._setScrollAreaY(this._startAtBottom?-this._limitAreaY:0))},dispose:function(){this._disableScrollBar||this._ui.scrollBar.css({height:0}),this._setScrollAreaY(0),this._removeEventLitener(),this._clearTimer()},_setScrollBar:function(t,i){if(!this._disableScrollBar){var s=~~(t*t/i);this._ui.scrollBar.css({height:s+"px"}),this._distScroll=i-t,this._distBar=t-s}},_addEventLitener:function(){return this._ui.scrollArea.on("touchstart",s.proxy(this._onStart,this)).on("touchend",s.proxy(this._onEnd,this)),this},_removeEventLitener:function(){return this._ui.scrollArea.off("touchstart").off("touchend").off("touchmove"),this},_onStart:function(t){t=t.originalEvent,this._clearTimer(),this._isTouching=!0,this._preAreaY=0,this._speedY=0,this._startTouchY=h?t.changedTouches[0].pageY:t.pageY,this._startAreaY=this._getScrollAreaY(),this._ui.scrollArea.on("touchmove",s.proxy(this._onMove,this))},_onEnd:function(t){t=t.originalEvent;var i=h?t.changedTouches[0].pageY:t.pageY;this._startTouchY-i<5&&this._startTouchY-i>-5&&(this._speedY=0),this._startTouchY-i<0&&this._speedY<0&&(this._speedY*=-1),this._isTouching=!1,this._ui.scrollArea.off("touchmove"),this._setTimer()},_onMove:function(t){t=t.originalEvent,t.preventDefault();var i=h?t.changedTouches[0].pageY:t.pageY,s=this._getScrollAreaY();this._newAreaY=i-this._startTouchY+this._startAreaY,this._setScrollAreaY(this._newAreaY),this._speedY=s-this._preAreaY,this._speedY<-20&&(this._speedY=-20+.1*this._speedY),this._speedY>20&&(this._speedY=20+.1*this._speedY),this._preAreaY=s,this._newBarY=this._newAreaY*this._distBar/this._distScroll,this._followScrollBar()},_getScrollAreaY:function(){var t=l(this._ui.scrollArea[0]),i=t.split(",")[1]||0;return i=parseInt(i,10)},_setScrollAreaY:function(t){t=parseInt(t,10),r(this._ui.scrollArea[0],0,t)},_followScrollBar:function(){this._disableScrollBar||(this._newBarY=this._newAreaY*this._distBar/this._distScroll,r(this._ui.scrollBar[0],0,-this._newBarY))},_setTimer:function(){return this._timer=setInterval(s.proxy(this._loop,this),15),this},_clearTimer:function(){return clearInterval(this._timer),this._timer=null,this},_loop:function(){if(!this._isTouching){var t=this._getScrollAreaY();t>0?(this._newAreaY=t-t/12,this._speedY=0,this._setScrollAreaY(this._newAreaY),2>t&&this._setScrollAreaY(0)):t<-this._limitAreaY?(this._newAreaY=t+(-this._limitAreaY-t)/12,this._speedY=0,this._setScrollAreaY(this._newAreaY),t>-this._limitAreaY-1&&this._setScrollAreaY(this._limitAreaY)):(this._newAreaY=t+this._speedY,this._speedY*=.9,this._setScrollAreaY(this._newAreaY),Math.abs(this._speedY)<.1&&(this._speedY=0),0===this._speedY&&this._clearTimer()),this._followScrollBar()}}},i});